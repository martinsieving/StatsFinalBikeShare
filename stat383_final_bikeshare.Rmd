---
title: "STAT383 Final Project: Bikeshare"
output: html_notebook
---

Referencing key packages:
```{r}

library(tidyverse)
library(janitor)
library(here)
library(rwunderground)
library(openmeteo)
library(ggplot2)
library(geosphere)

```

Loading raw Seoul bikeshare date (hourly):
```{r}

thisfile=here("SeoulBikeData.csv")

bikes_raw = read_csv(thisfile) %>% clean_names()

```

Removing outlier days (holidays and nonfunctioning), removing variables not relevant to regression, and combining precipitation variables by equivalent rain height (NSSL 1mm rain = 13mm snow) (eql_rain_mm):
```{r}

bikes_filter = bikes_raw |> 
  filter(holiday == "No Holiday", functioning_day == "Yes") |> 
  select(-date, -dew_point_temperature, -solar_radiation_mj_m2, -seasons, -holiday, -functioning_day)

bikes_total = bikes_filter |> 
  mutate(eql_rain_mm = rainfall_mm + snowfall_cm/10/13) |> 
  select(-rainfall_mm, -snowfall_cm)

glimpse(bikes_total)

```

Building linear regression model for ridership as a function of the following variables- hour, temperature, humidity, windspeed, visibility, and precipitation:
```{r}

regression_total = lm(data = bikes_total, rented_bike_count ~ hour + temperature_c + humidity_percent + wind_speed_m_s + visibility_10m + eql_rain_mm)

summary(regression_total) 

# This builds a regression model to predict total hourly ridership as with all variables as inputs, as opposed to drawing intependent trends for each variable.

```

Independent regression model for ridership vs hour of day:
```{r}

reg_hour = lm(data = bikes_total, rented_bike_count ~ hour)
summary(reg_hour) 

hour_plot = ggplot(data = bikes_total,
                   aes(x = hour, y = rented_bike_count)) +
                     geom_point(alpha = 0.1, color = "blue") +
                     geom_smooth(color = "green", linewidth = 2)
                   
hour_plot

```

